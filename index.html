<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock My Heart - A Romantic Mini-Game</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #f9e6f0;
            color: #4a4a4a;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-container {
            width: 100%;
            max-width: 600px;
            min-height: 500px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(219, 112, 147, 0.2);
            padding: 20px;
            position: relative;
            overflow: hidden;
            margin: 20px;
        }

        .floating-hearts {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .heart {
            position: absolute;
            width: 20px;
            height: 20px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff6b9d"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') no-repeat center center;
            background-size: contain;
            opacity: 0.7;
            animation: float 10s linear infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100%) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        h1, h2, h3 {
            color: #db7093;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }

        button {
            background-color: #db7093;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(219, 112, 147, 0.3);
            margin: 10px auto;
            display: block;
            position: relative;
            z-index: 2;
        }

        button:hover {
            background-color: #c25a7c;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(219, 112, 147, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100%;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            padding: 20px;
            z-index: 2;
            background-color: white;
        }

        .active {
            display: flex;
        }

        .message {
            background-color: #fff0f5;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #db7093;
            font-style: italic;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 2px 10px rgba(219, 112, 147, 0.1);
        }

        .level-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .lock-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .scramble-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .letter-tile {
            width: 50px;
            height: 50px;
            background-color: #f8c9db;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: move;
            user-select: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .letter-slot {
            width: 50px;
            height: 50px;
            border: 2px dashed #db7093;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .heart-game {
            width: 100%;
            height: 300px;
            position: relative;
            overflow: hidden;
            border: 2px solid #f8c9db;
            border-radius: 10px;
            margin: 20px 0;
        }

        .falling-heart {
            position: absolute;
            font-size: 24px;
            animation: fall linear;
        }

        @keyframes fall {
            from { top: -20px; }
            to { top: 100%; }
        }

        .heart-basket {
            position: absolute;
            bottom: 10px;
            width: 80px;
            height: 40px;
            background-color: #db7093;
            border-radius: 40px 40px 0 0;
            left: calc(50% - 40px);
            display: flex;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
        }

        .jigsaw-puzzle {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin: 20px auto;
            width: 270px;
            height: 270px;
        }

        .puzzle-piece {
            background-color: #f8c9db;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            width: 100%;
            height: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .spot-difference {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
        }

        .spot-image {
            width: 100%;
            height: 120px;
            background-color: #f8c9db;
            border-radius: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            padding: 10px;
        }

        .spot-item {
            width: 30px;
            height: 30px;
            background-color: #db7093;
            border-radius: 50%;
            margin: 5px;
            cursor: pointer;
        }

        .spot-different {
            background-color: #f06292;
        }

        .song-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
            width: 100%;
        }

        .song-option {
            padding: 10px;
            background-color: #f8c9db;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .song-option:hover {
            background-color: #f6b6cf;
        }

        .shayari-container {
            margin: 20px 0;
            font-style: italic;
            line-height: 1.6;
            direction: rtl;
            text-align: right;
        }

        .shayari-blank {
            display: inline-block;
            border-bottom: 2px solid #db7093;
            width: 80px;
            height: 24px;
            margin: 0 5px;
            vertical-align: middle;
        }

        .shayari-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            direction: ltr;
        }

        .shayari-option {
            padding: 6px 12px;
            background-color: #f8c9db;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
        }

        .maze-container {
            width: 300px;
            height: 300px;
            background-color: #fff0f5;
            border: 2px solid #db7093;
            border-radius: 10px;
            position: relative;
            margin: 20px auto;
            overflow: hidden;
        }

        .maze-heart {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #db7093;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 2;
        }

        .maze-wall {
            position: absolute;
            background-color: #f06292;
            z-index: 1;
        }

        .maze-target {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #f06292;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 1;
        }

        .riddle-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
            width: 100%;
        }

        #level-9-message, #level-9-next {
            display: block !important;
            visibility: visible;
            opacity: 1;
        }


        .firework-container {
            width: 100%;
            height: 300px;
            position: relative;
            margin: 20px auto;
            background-color: #120021;
            border-radius: 10px;
            overflow: hidden;
        }

        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: firework-explode 1s ease-out forwards;
        }

        @keyframes firework-explode {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--dx), var(--dy));
                opacity: 0;
            }
        }

        .final-message {
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
            opacity: 0;
            animation: final-appear 3s forwards;
            animation-delay: 2s;
        }

        @keyframes final-appear {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .progress-container {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .level-indicator {
            font-size: 14px;
            color: #db7093;
        }

        @media (max-width: 600px) {
            .jigsaw-puzzle {
                width: 240px;
                height: 240px;
            }
            
            .maze-container {
                width: 250px;
                height: 250px;
            }
            
            .letter-tile, .letter-slot {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .heart-game {
                height: 250px;
            }
            
            .progress-container {
                top: 10px;
                left: 10px;
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="progress-container">
        <div class="level-indicator">Level: <span id="current-level">Start</span></div>
    </div>

    <div id="game-container">
        <div class="floating-hearts" id="floating-hearts"></div>

        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <h1>Unlock My Heart</h1>
            <p>A journey of love awaits you...</p>
            <p>Complete all 10 challenges to unlock my heart ‚ù§Ô∏è</p>
            <button id="start-button">Start Game</button>
        </div>

        <!-- Level 1: Unlock the Love Lock
        <div id="level-1" class="screen">
            <h2>Level 1: Unlock the Love Lock</h2>
            <p>Click the buttons in the correct order to unlock my heart</p>
            <div class="lock-buttons">
                <button class="lock-button" data-index="1">1</button>
                <button class="lock-button" data-index="2">2</button>
                <button class="lock-button" data-index="3">3</button>
                <button class="lock-button" data-index="4">4</button>
            </div>
            <div id="level-1-message" class="message" style="display: none;">
                You unlocked the first key to my heart!
            </div>
            <button id="level-1-next" style="display: none;">Next Level</button>
        </div> -->
        <!-- Level 1: Unlock the Love Lock -->
<div id="level-1" class="screen">
    <h2>Level 1: Unlock the Love Lock</h2>
    <p>Click the buttons in the correct order to unlock my heart</p>
    <div class="lock-buttons">
        <button class="lock-button" data-index="0">1</button>
        <button class="lock-button" data-index="1">2</button>
        <button class="lock-button" data-index="2">3</button>
        <button class="lock-button" data-index="3">4</button>
    </div>
    <div id="level-1-message" class="message" style="display: none;">
        You unlocked the first key to my heart!
    </div>
    <button id="level-1-next" style="display: none;">Next Level</button>
</div>


        <!-- Level 2: Find My Name -->
        <div id="level-2" class="screen">
            <h2>Level 2: Find My Name</h2>
            <p>Arrange the letters to spell my name</p>
            <div class="scramble-container" id="name-slots"></div>
            <div class="scramble-container" id="name-letters"></div>
            <div id="level-2-message" class="message" style="display: none;">
                My name belongs in your heart forever!
            </div>
            <button id="level-2-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 3: Catch the Hearts -->
        <div id="level-3" class="screen">
            <h2>Level 3: Catch the Hearts</h2>
            <p>Catch 10 falling hearts with the basket (move with left/right arrows or tap sides)</p>
            <div class="heart-game" id="heart-game">
                <div class="heart-basket" id="heart-basket">‚ù§Ô∏è</div>
            </div>
            <p>Hearts caught: <span id="hearts-caught">0</span>/10</p>
            <div id="level-3-message" class="message" style="display: none;">
                Every heartbeat is for you!
            </div>
            <button id="level-3-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 4: Love Puzzle -->
        <div id="level-4" class="screen">
            <h2>Level 4: Love Puzzle</h2>
            <p>Click the pieces to swap them and solve the puzzle</p>
            <div class="jigsaw-puzzle" id="jigsaw-puzzle"></div>
            <div id="level-4-message" class="message" style="display: none;">
                Our love is the perfect piece of the puzzle!
            </div>
            <button id="level-4-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 5: Spot the Difference -->
        <div id="level-5" class="screen">
            <h2>Level 5: Spot the Difference</h2>
            <p>Find 3 differences between these images</p>
            <div class="spot-difference">
                <div class="spot-image" id="spot-image-1"></div>
                <div class="spot-image" id="spot-image-2"></div>
            </div>
            <p>Differences found: <span id="differences-found">0</span>/3</p>
            <div id="level-5-message" class="message" style="display: none;">
                You always notice the little things about me!
            </div>
            <button id="level-5-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 6: Guess Our Song -->
        <div id="level-6" class="screen">
            <h2>Level 6: Guess Our Song</h2>
            <p>Listen to the melody and pick our special song</p>
            <button id="play-melody">Play Melody</button>
            <div class="song-options">
                <div class="song-option" data-correct="false">Perfect - Ed Sheeran</div>
                <div class="song-option" data-correct="true">Can't Help Falling in Love - Elvis Presley</div>
                <div class="song-option" data-correct="false">All of Me - John Legend</div>
                <div class="song-option" data-correct="false">A Thousand Years - Christina Perri</div>
            </div>
            <div id="level-6-message" class="message" style="display: none;">
                Our love has its own melody!
            </div>
            <button id="level-6-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 7: Complete the Shayari -->
         <div id="level-7" class="screen">
            <h2>Level 7: Complete the Shayari</h2>
            <p>Choose the correct words to complete this beautiful shayari</p>
            <div class="shayari-container">
                <p>Mohabbat mein <span class="shayari-blank" data-index="0"></span> ki zaroorat nahi</p>
                <p><span class="shayari-blank" data-index="1"></span> dil hi kaafi hai</p>
                <p>Tum <span class="shayari-blank" data-index="2"></span> mein raho ya na raho</p>
                <p>Tum mere <span class="shayari-blank" data-index="3"></span> mein hamesha rahoge</p>
            </div>
            <div class="shayari-options">
                <div class="shayari-option" data-word="alfaz" data-index="0">Alfaz</div>
                <div class="shayari-option" data-word="ek" data-index="1">Ek</div>
                <div class="shayari-option" data-word="zindagi" data-index="2">Zindagi</div>
                <div class="shayari-option" data-word="dil" data-index="3">Dil</div>
                <div class="shayari-option" data-word="aankhon" data-index="0">Aankhon</div>
                <div class="shayari-option" data-word="do" data-index="1">Do</div>
                <div class="shayari-option" data-word="duniya" data-index="2">Duniya</div>
                <div class="shayari-option" data-word="khayalon" data-index="3">Khayalon</div>
            </div>
            <div id="level-7-message" class="message" style="display: none;">
                Every line I write is for you!
            </div>
            <button id="level-7-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 8: Maze to My Heart -->
        <div id="level-8" class="screen">
            <h2>Level 8: Maze to My Heart</h2>
            <p>Guide the heart to the target (use arrow keys or swipe)</p>
            <div class="maze-container" id="maze-container">
                <div class="maze-heart" id="maze-heart">‚ù§Ô∏è</div>
                <div class="maze-target" id="maze-target">üíó</div>
                <!-- Walls will be added by JavaScript -->
            </div>
            <div id="level-8-message" class="message" style="display: none;">
                No matter what, my heart will always find you!
            </div>
            <button id="level-8-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 9: Love Riddle -->
        <div id="level-9" class="screen">
            <h2>Level 9: Love Riddle</h2>
            <p>Solve this riddle to unlock the next level:</p>
            <div class="message">
                "I am always with you but you cannot touch me. I grow when you share me but fade when neglected. What am I?"
            </div>
            <div class="riddle-options">
                <button class="riddle-option" data-correct="false">Memory</button>
                 <button class="riddle-option" data-correct="true">Love</button>
                <button class="riddle-option" data-correct="false">Happiness</button>
                <button class="riddle-option" data-correct="false">Promise</button>
            </div>
            <div id="level-9-message" class="message" style="display: none;">
                You are the answer to all my questions!
            </div>
            <button id="level-9-next" style="display: none;">Next Level</button>
        </div>

        <!-- Level 10: Fireworks Finale -->
        <div id="level-10" class="screen">
            <h2>Level 10: The Final Test</h2>
            <p>Spell my name with fireworks to unlock my heart completely</p>
            <div class="scramble-container">
                <button class="letter-button" data-letter="S">S</button>
                <button class="letter-button" data-letter="U">U</button>
                <button class="letter-button" data-letter="F">F</button>
                <button class="letter-button" data-letter="I">I</button>
                <button class="letter-button" data-letter="Y">Y</button>
                <button class="letter-button" data-letter="A">A</button>
                <button class="letter-button" data-letter="N">N</button>
            </div>
            <p>Spelled: <span id="spelled-name"></span></p>
            <div class="firework-container" id="firework-container">
                <div class="final-message" id="final-message" style="display: none;">
                    YOU UNLOCKED MY HEART ‚ù§Ô∏è
                </div>
            </div>
            <div id="level-10-message" class="message" style="display: none;">
                My heart is yours forever!
            </div>
            <button id="play-again" style="display: none;">Play Again</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script>
        // Game state
        const gameState = {
            currentLevel: 0,
            lockCombination: [0, 2, 1, 3],
            lockAttempt: [],
            heartsCaught: 0,
            differencesFound: 0,
            currentShayariWords: Array(4).fill(null),
            spellProgress: '',
            mazePath: {
                x: 1,
                y: 1
            }
        };

        // DOM Elements
        const levelIndicator = document.getElementById('current-level');
        const startButton = document.getElementById('start-button');
        const floatingHeartsContainer = document.getElementById('floating-hearts');

        // Create floating hearts background
        function createFloatingHearts() {
            floatingHeartsContainer.innerHTML = '';
            for (let i = 0; i < 20; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.animationDuration = `${10 + Math.random() * 15}s`;
                heart.style.animationDelay = `${Math.random() * 10}s`;
                floatingHeartsContainer.appendChild(heart);
            }
        }
        createFloatingHearts();

        // Show level and update indicator
        function showLevel(level) {
            gameState.currentLevel = level;
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(`level-${level}`).classList.add('active');
            levelIndicator.textContent = level === 0 ? 'Start' : level;
            
            // Initialize level-specific elements
            if (level === 2) {
                initializeNameScramble();
            } else if (level === 3) {
                initializeHeartGame();
            } else if (level === 4) {
                initializeJigsawPuzzle();
            } else if (level === 5) {
                initializeSpotDifference();
            } else if (level === 8) {
                initializeMaze();
            } else if (level === 10) {
                document.getElementById('spelled-name').textContent = '';
                gameState.spellProgress = '';
            }
        }

        // Start Button Event
        startButton.addEventListener('click', () => {
    console.log("Start button clicked");
    showLevel(1);
});

//         // Level 1: Lock Buttons
//         // Define the correct sequence

(() => {
    const gameState = {
        lockCombination: [0, 1, 2, 3],
        lockAttempt: []
    };

    const lockButtons = document.querySelectorAll('.lock-button');

    lockButtons.forEach(button => {
        button.addEventListener('click', () => {
            const index = parseInt(button.getAttribute('data-index'));

            if (gameState.lockAttempt.length >= gameState.lockCombination.length) return;

            gameState.lockAttempt.push(index);
            button.style.backgroundColor = '#f06292';

            if (gameState.lockAttempt.length === gameState.lockCombination.length) {
                let correct = gameState.lockAttempt.every((val, i) => val === gameState.lockCombination[i]);

                if (correct) {
                    document.getElementById('level-1-message').style.display = 'block';
                    document.getElementById('level-1-next').style.display = 'block';

                    lockButtons.forEach(btn => btn.disabled = true);
                } else {
                    gameState.lockAttempt = [];
                    setTimeout(() => {
                        lockButtons.forEach(btn => {
                            btn.style.backgroundColor = '#db7093';
                        });
                    }, 500);
                }
            }
        });
    });

    document.getElementById('level-1-next').addEventListener('click', () => {
        showLevel(2);
    });
})();

// let gameState = {
//     lockCombination: [0, 1, 2, 3],  // Correct order: 1 ‚Üí 2 ‚Üí 3 ‚Üí 4
//     lockAttempt: []  // Stores user's input
// };

// // Get all buttons
// const lockButtons = document.querySelectorAll('.lock-button');

// // Add event listeners to buttons
// lockButtons.forEach(button => {
//     button.addEventListener('click', () => {
//         const index = parseInt(button.getAttribute('data-index'));

//         // Prevent further clicks after success
//         if (gameState.lockAttempt.length >= gameState.lockCombination.length) return;

//         gameState.lockAttempt.push(index);

//         // Change button color to indicate selection
//         button.style.backgroundColor = '#f06292';

//         // Check if sequence matches
//         if (gameState.lockAttempt.length === gameState.lockCombination.length) {
//             let correct = gameState.lockAttempt.every((val, i) => val === gameState.lockCombination[i]);

//             if (correct) {
//                 // Display success message and Next Level button
//                 document.getElementById('level-1-message').style.display = 'block';
//                 document.getElementById('level-1-next').style.display = 'block';

//                 // Disable further button clicks
//                 lockButtons.forEach(btn => btn.disabled = true);
//             } else {
//                 // Reset wrong attempt
//                 gameState.lockAttempt = [];

//                 // Reset button colors after short delay
//                 setTimeout(() => {
//                     lockButtons.forEach(btn => {
//                         btn.style.backgroundColor = '#db7093';
//                     });
//                 }, 500);
//             }
//         }
//     });
// });

// // Move to next level
// document.getElementById('level-1-next').addEventListener('click', () => {
//     showLevel(2);
// });


        
        // Level 2: Name Scramble
        function initializeNameScramble() {
            const name = 'SUFIYAN';
            const nameSlots = document.getElementById('name-slots');
            const nameLetters = document.getElementById('name-letters');
            
            nameSlots.innerHTML = '';
            nameLetters.innerHTML = '';
            
            // Create slots
            for (let i = 0; i < name.length; i++) {
                const slot = document.createElement('div');
                slot.classList.add('letter-slot');
                slot.setAttribute('data-index', i);
                nameSlots.appendChild(slot);
            }
            
            // Create scrambled letters
            const scrambled = name.split('').sort(() => Math.random() - 0.5);
            for (let i = 0; i < scrambled.length; i++) {
                const letter = document.createElement('div');
                letter.classList.add('letter-tile');
                letter.textContent = scrambled[i];
                letter.setAttribute('data-letter', scrambled[i]);
                letter.setAttribute('draggable', true);
                
                letter.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', scrambled[i]);
                    setTimeout(() => {
                        letter.style.opacity = '0.5';
                    }, 0);
                });
                
                letter.addEventListener('dragend', () => {
                    letter.style.opacity = '1';
                });
                
                letter.addEventListener('click', () => {
                    // Find the first empty slot
                    const slots = document.querySelectorAll('.letter-slot');
                    for (const slot of slots) {
                        if (!slot.hasChildNodes()) {
                            slot.appendChild(letter);
                            checkNameCompletion();
                            break;
                        }
                    }
                });
                
                nameLetters.appendChild(letter);
            }
            
            // Add event listeners for slots
            const slots = document.querySelectorAll('.letter-slot');
            slots.forEach(slot => {
                slot.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                
                slot.addEventListener('drop', (e) => {
                    e.preventDefault();
                    if (slot.hasChildNodes()) return;
                    
                    const letter = e.dataTransfer.getData('text/plain');
                    const letterElements = document.querySelectorAll('.letter-tile');
                    
                    for (const elem of letterElements) {
                        if (elem.textContent === letter && !elem.parentElement.classList.contains('letter-slot')) {
                            slot.appendChild(elem);
                            checkNameCompletion();
                            break;
                        }
                    }
                });
            });
        }


        function checkNameCompletion() {
    const slots = document.querySelectorAll('.letter-slot');
    let completedName = '';

    slots.forEach(slot => {
        if (slot.hasChildNodes()) {
            completedName += slot.firstChild.textContent;
        }
    });

    if (completedName === 'SUFIYAN') {
        alert('Congratulations! You unscrambled the name correctly!');
    }
}

// Fix: Ensure the following logic is inside a function or event listener
document.querySelectorAll('.letter-tile').forEach(elem => {
    elem.addEventListener('click', function () {
        const letter = elem.getAttribute('data-letter');
        const slot = document.querySelector('.letter-slot:not(:has(*))'); // Find the first empty slot

        if (slot) {
            slot.appendChild(elem);
            checkNameCompletion();
        }
    });
});


    //     function checkNameCompletion() {
    //         const slots = document.querySelectorAll('.letter-slot');
    //         let completedName = '';

    //         slots.forEach(slot => {
    //             if (slot.hasChildNodes()) {
    //                 completedName += slot.firstChild.textContent;
    //             }
    //         });

    //         if (completedName === 'SUFIYAN') {
    //             alert('Congratulations! You unscrambled the name correctly!');
    //         }
    //     }
    //     if (elem.getAttribute('data-letter') === letter && !elem.parentElement.classList.contains('letter-slot')) {
    // slot.appendChild(elem);
    // checkNameCompletion();
    // return; // ‚úÖ Corrected: Stops function execution
    // }

                
    document.querySelectorAll('.letter-slot').forEach(slot => {
    slot.addEventListener('click', () => {
        // Return the letter to the container if clicked on a filled slot
        if (slot.hasChildNodes()) {
            document.getElementById('name-letters').appendChild(slot.firstChild);
            checkNameCompletion();
        }
    });
}); // ‚úÖ Properly closed forEach loop

        
        function checkNameCompletion() {
            const name = 'SUFIYAN';
            const slots = document.querySelectorAll('.letter-slot');
            let current = '';
            
            slots.forEach(slot => {
                if (slot.hasChildNodes()) {
                    current += slot.firstChild.getAttribute('data-letter');
                }
            });
            
            if (current === name) {
                document.getElementById('level-2-message').style.display = 'block';
                document.getElementById('level-2-next').style.display = 'block';
            }
        }
        
        document.getElementById('level-2-next').addEventListener('click', () => {
            showLevel(3);
        });
        
        // Level 3: Catch the Hearts
        function initializeHeartGame() {
            gameState.heartsCaught = 0;
            document.getElementById('hearts-caught').textContent = '0';
            
            const heartGame = document.getElementById('heart-game');
            const heartBasket = document.getElementById('heart-basket');
            let basketPosition = 50; // in percentage
            let heartsFalling = 0;
            let gameActive = true;
            
            // Update basket position
            function updateBasketPosition() {
                heartBasket.style.left = `calc(${basketPosition}% - 40px)`;
            }
            
            // Move basket with keyboard
            document.addEventListener('keydown', (e) => {
                if (!gameActive || gameState.currentLevel !== 3) return;
                
                if (e.key === 'ArrowLeft') {
                    basketPosition = Math.max(0, basketPosition - 5);
                } else if (e.key === 'ArrowRight') {
                    basketPosition = Math.min(100, basketPosition + 5);
                }
                
                updateBasketPosition();
            });
            
            // Move basket with touch
            heartGame.addEventListener('touchstart', (e) => {
                if (!gameActive || gameState.currentLevel !== 3) return;
                e.preventDefault();
                
                const touch = e.touches[0];
                const gameRect = heartGame.getBoundingClientRect();
                const touchX = touch.clientX - gameRect.left;
                
                if (touchX < gameRect.width / 2) {
                    basketPosition = Math.max(0, basketPosition - 10);
                } else {
                    basketPosition = Math.min(100, basketPosition + 10);
                }
                
                updateBasketPosition();
            });
            
            // Spawn falling hearts
            function spawnHeart() {
                if (!gameActive || gameState.currentLevel !== 3) return;
                
                const heart = document.createElement('div');
                heart.classList.add('falling-heart');
                heart.textContent = '‚ù§Ô∏è';
                heart.style.left = `${Math.random() * 90 + 5}%`;
                heart.style.animationDuration = `${Math.random() * 2 + 2}s`;
                
                heartGame.appendChild(heart);
                heartsFalling++;
                
                // Check for collision when heart reaches bottom
                const animationDuration = parseFloat(heart.style.animationDuration) * 1000;
                setTimeout(() => {
                    if (!heart.parentNode) return;
                    
                    const heartRect = heart.getBoundingClientRect();
                    const basketRect = heartBasket.getBoundingClientRect();
                    
                    if (
                        heartRect.left < basketRect.right &&
                        heartRect.right > basketRect.left &&
                        heartRect.bottom >= basketRect.top
                    ) {
                        // Caught heart
                        heart.remove();
                        heartsFalling--;
                        gameState.heartsCaught++;
                        document.getElementById('hearts-caught').textContent = gameState.heartsCaught;
                        
                        if (gameState.heartsCaught >= 10) {
                            gameActive = false;
                            document.getElementById('level-3-message').style.display = 'block';
                            document.getElementById('level-3-next').style.display = 'block';
                        }
                    } else {
                        // Missed heart
                        heart.remove();
                        heartsFalling--;
                    }
                }, animationDuration - 100);
            }
            
            // Start spawning hearts
            updateBasketPosition();
            const heartInterval = setInterval(() => {
                if (gameActive && gameState.currentLevel === 3 && heartsFalling < 5) {
                    spawnHeart();
                }
                
                if (gameState.currentLevel !== 3) {
                    clearInterval(heartInterval);
                }
            }, 1000);
        }
        
        document.getElementById('level-3-next').addEventListener('click', () => {
            showLevel(4);
        });
        
        // Level 4: Jigsaw Puzzle
        function initializeJigsawPuzzle() {
            const puzzle = document.getElementById('jigsaw-puzzle');
            puzzle.innerHTML = '';
            
            // Create heart pattern pieces
            const heartPattern = [
                '‚ù§Ô∏è', '‚ù§Ô∏è', '‚ù§Ô∏è',
                '‚ù§Ô∏è', '‚ù§Ô∏è', '‚ù§Ô∏è',
                '‚ù§Ô∏è', '‚ù§Ô∏è', '‚ù§Ô∏è'
            ];
            
            // Scramble pattern
            const scrambledPattern = [...heartPattern].sort(() => Math.random() - 0.5);
            
            // Create puzzle pieces
            for (let i = 0; i < 9; i++) {
                const piece = document.createElement('div');
                piece.classList.add('puzzle-piece');
                piece.textContent = scrambledPattern[i];
                piece.setAttribute('data-index', i);
                
                piece.addEventListener('click', () => {
                    if (gameState.selectedPiece === undefined) {
                        // Select this piece
                        gameState.selectedPiece = i;
                        piece.style.backgroundColor = '#f06292';
                    } else {
                        // Swap with selected piece
                        const pieces = document.querySelectorAll('.puzzle-piece');
                        const temp = pieces[gameState.selectedPiece].textContent;
                        pieces[gameState.selectedPiece].textContent = piece.textContent;
                        piece.textContent = temp;
                        
                        // Reset selection
                        pieces[gameState.selectedPiece].style.backgroundColor = '#f8c9db';
                        gameState.selectedPiece = undefined;
                        
                        // Check if completed
                        checkPuzzleCompletion();
                    }
                });
                
                puzzle.appendChild(piece);
            }
        }
        
        function checkPuzzleCompletion() {
            // For this puzzle, just check if all pieces are hearts
            let complete = true;
            const pieces = document.querySelectorAll('.puzzle-piece');
            
            // Simple check - all pieces should have the same content
            const firstPiece = pieces[0].textContent;
            for (let i = 1; i < pieces.length; i++) {
                if (pieces[i].textContent !== firstPiece) {
                    complete = false;
                    break;
                }
            }
            
            if (complete) {
                document.getElementById('level-4-message').style.display = 'block';
                document.getElementById('level-4-next').style.display = 'block';
            }
        }
        
        document.getElementById('level-4-next').addEventListener('click', () => {
            showLevel(5);
        });
        
        // Level 5: Spot the Difference
        function initializeSpotDifference() {
            const spotImage1 = document.getElementById('spot-image-1');
            const spotImage2 = document.getElementById('spot-image-2');
            
            spotImage1.innerHTML = '';
            spotImage2.innerHTML = '';
            gameState.differencesFound = 0;
            document.getElementById('differences-found').textContent = '0';
            
            // Create items
            const totalItems = 12;
            const differentItems = 3;
            const differentIndices = [];
            
            // Choose different item indices
            while (differentIndices.length < differentItems) {
                const index = Math.floor(Math.random() * totalItems);
                if (!differentIndices.includes(index)) {
                    differentIndices.push(index);
                }
            }
            
            // Create spot items
            for (let i = 0; i < totalItems; i++) {
                const item1 = document.createElement('div');
                item1.classList.add('spot-item');
                item1.setAttribute('data-index', i);
                
                const item2 = document.createElement('div');
                item2.classList.add('spot-item');
                item2.setAttribute('data-index', i);
                
                if (differentIndices.includes(i)) {
                    item2.classList.add('spot-different');
                    
                    item2.addEventListener('click', () => {
                        if (!item2.classList.contains('found')) {
                            item2.classList.add('found');
                            item2.style.backgroundColor = '#4CAF50';
                            gameState.differencesFound++;
                            document.getElementById('differences-found').textContent = gameState.differencesFound;
                            
                            if (gameState.differencesFound >= differentItems) {
                                document.getElementById('level-5-message').style.display = 'block';
                                document.getElementById('level-5-next').style.display = 'block';
                            }
                        }
                    });
                }
                
                spotImage1.appendChild(item1);
                spotImage2.appendChild(item2);
            }
        }
        
        document.getElementById('level-5-next').addEventListener('click', () => {
            showLevel(6);
        });
        
        // Level 6: Guess Our Song
        document.getElementById('play-melody').addEventListener('click', () => {
            // Simple melody representation with frequencies and durations
            const melody = [
                { frequency: 261.63, duration: 500 },  // C4
                { frequency: 293.66, duration: 500 },  // D4
                { frequency: 329.63, duration: 1000 },  // E4
                { frequency: 349.23, duration: 500 },  // F4
                { frequency: 392.00, duration: 1000 },  // G4
                { frequency: 440.00, duration: 500 },  // A4
                { frequency: 392.00, duration: 1500 }   // G4
            ];
            
            // Play the melody
            let time = 0;
            for (const note of melody) {
                setTimeout(() => {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.value = note.frequency;
                    gainNode.gain.value = 0.5;
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.start();
                    
                    setTimeout(() => {
                        gainNode.gain.setValueAtTime(gainNode.gain.value, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
                        setTimeout(() => {
                            oscillator.stop();
                        }, 100);
                    }, note.duration);
                }, time);
                
                time += note.duration + 50;
            }
        });
        
        const songOptions = document.querySelectorAll('.song-option');
        songOptions.forEach(option => {
            option.addEventListener('click', () => {
                const correct = option.getAttribute('data-correct') === 'true';
                
                songOptions.forEach(opt => {
                    opt.style.backgroundColor = '#f8c9db';
                });
                
                if (correct) {
                    option.style.backgroundColor = '#4CAF50';
                    document.getElementById('level-6-message').style.display = 'block';
                    document.getElementById('level-6-next').style.display = 'block';
                } else {
                    option.style.backgroundColor = '#FF5252';
                }
            });
        });
        
        document.getElementById('level-6-next').addEventListener('click', () => {
            showLevel(7);
        });
        
        // Level 7: Complete the Shayari
        const shayariOptions = document.querySelectorAll('.shayari-option');
        const shayariBlanks = document.querySelectorAll('.shayari-blank');
        
        shayariOptions.forEach(option => {
            option.addEventListener('click', () => {
                const word = option.getAttribute('data-word');
                const index = parseInt(option.getAttribute('data-index'));
                
                // Update the blank with this word
                shayariBlanks[index].textContent = word;
                gameState.currentShayariWords[index] = word;
                
                // Check if all correct words are selected
                checkShayariCompletion();
            });
        });
        
        function checkShayariCompletion() {
            const correctWords = ['alfaz', 'ek', 'duniya', 'dil'];
            let allCorrect = true;
            
            for (let i = 0; i < correctWords.length; i++) {
                if (gameState.currentShayariWords[i] !== correctWords[i]) {
                    allCorrect = false;
                    break;
                }
            }
            
            if (allCorrect) {
                document.getElementById('level-7-message').style.display = 'block';
                document.getElementById('level-7-next').style.display = 'block';
            }
        }
        
        document.getElementById('level-7-next').addEventListener('click', () => {
            showLevel(8);
        });
        
        // Level 8: Maze to My Heart
        function initializeMaze() {
            const mazeContainer = document.getElementById('maze-container');
            const mazeHeart = document.getElementById('maze-heart');
            const mazeTarget = document.getElementById('maze-target');
            
            // Clear existing walls
            document.querySelectorAll('.maze-wall').forEach(wall => wall.remove());
            
            // Maze configuration (0 = empty, 1 = wall)
            const mazeGrid = [
                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                [1, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                [1, 0, 1, 0, 1, 0, 1, 1, 0, 1],
                [1, 0, 1, 0, 0, 0, 0, 1, 0, 1],
                [1, 0, 1, 1, 1, 1, 0, 1, 0, 1],
                [1, 0, 0, 0, 0, 0, 0, 1, 0, 1],
                [1, 1, 1, 1, 1, 1, 0, 1, 0, 1],
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
                [1, 0, 1, 1, 1, 1, 1, 1, 0, 1],
                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
            ];
            
            // Calculate cell size
            const cellSize = Math.min(
                mazeContainer.clientWidth / mazeGrid[0].length,
                mazeContainer.clientHeight / mazeGrid.length
            );
            
            // Reset and position heart
            gameState.mazePath = { x: 1, y: 1 };
            mazeHeart.style.top = `${gameState.mazePath.y * cellSize}px`;
            mazeHeart.style.left = `${gameState.mazePath.x * cellSize}px`;
            mazeHeart.style.width = `${cellSize}px`;
            mazeHeart.style.height = `${cellSize}px`;
            
            // Position target
            mazeTarget.style.top = `${8 * cellSize}px`;
            mazeTarget.style.left = `${8 * cellSize}px`;
            mazeTarget.style.width = `${cellSize}px`;
            mazeTarget.style.height = `${cellSize}px`;
            
            // Create walls
            for (let y = 0; y < mazeGrid.length; y++) {
                for (let x = 0; x < mazeGrid[y].length; x++) {
                    if (mazeGrid[y][x] === 1) {
                        const wall = document.createElement('div');
                        wall.classList.add('maze-wall');
                        wall.style.top = `${y * cellSize}px`;
                        wall.style.left = `${x * cellSize}px`;
                        wall.style.width = `${cellSize}px`;
                        wall.style.height = `${cellSize}px`;
                        mazeContainer.appendChild(wall);
                    }
                }
            }
            
            // Control the heart
            function moveHeart(dx, dy) {
                const newX = gameState.mazePath.x + dx;
                const newY = gameState.mazePath.y + dy;
                
                // Check if the move is valid
                if (
                    newX >= 0 && newX < mazeGrid[0].length &&
                    newY >= 0 && newY < mazeGrid.length &&
                    mazeGrid[newY][newX] === 0
                ) {
                    gameState.mazePath.x = newX;
                    gameState.mazePath.y = newY;
                    mazeHeart.style.left = `${newX * cellSize}px`;
                    mazeHeart.style.top = `${newY * cellSize}px`;
                    
                    // Check if reached target
                    if (newX === 8 && newY === 8) {
                        document.getElementById('level-8-message').style.display = 'block';
                        document.getElementById('level-8-next').style.display = 'block';
                    }
                }
            }
            
            // Keyboard controls
            document.addEventListener('keydown', (e) => {
                if (gameState.currentLevel !== 8) return;
                
                if (e.key === 'ArrowUp') {
                    moveHeart(0, -1);
                } else if (e.key === 'ArrowDown') {
                    moveHeart(0, 1);
                } else if (e.key === 'ArrowLeft') {
                    moveHeart(-1, 0);
                } else if (e.key === 'ArrowRight') {
                    moveHeart(1, 0);
                }
            });
            
            // Touch controls
            let touchStartX, touchStartY;
            
            mazeContainer.addEventListener('touchstart', (e) => {
                if (gameState.currentLevel !== 8) return;
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            });
            
            mazeContainer.addEventListener('touchend', (e) => {
                if (gameState.currentLevel !== 8) return;
                
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                const diffX = touchEndX - touchStartX;
                const diffY = touchEndY - touchStartY;
                
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    // Horizontal swipe
                    if (diffX > 0) {
                        moveHeart(1, 0); // Right
                    } else {
                        moveHeart(-1, 0); // Left
                    }
                } else {
                    // Vertical swipe
                    if (diffY > 0) {
                        moveHeart(0, 1); // Down
                    } else {
                        moveHeart(0, -1); // Up
                    }
                }
            });
        }
        
        document.getElementById('level-8-next').addEventListener('click', () => {
            showLevel(9);
        });
        
        // Level 9: Love Riddle
const riddleOptions = document.querySelectorAll('.riddle-option');

riddleOptions.forEach(option => {
    option.addEventListener('click', () => {
        const correct = option.getAttribute('data-correct') === 'true';
        
        riddleOptions.forEach(opt => {
            opt.style.backgroundColor = '#db7093';
        });
        
        if (correct) {
            console.log("Correct answer selected"); // Debugging line
            option.style.backgroundColor = '#4CAF50';
            
            // Ensure elements exist before modifying them
            const messageElement = document.getElementById('level-9-message');
            const nextButton = document.getElementById('level-9-next');

            if (messageElement && nextButton) {
                messageElement.style.display = 'block';
                nextButton.style.display = 'block';
            } else {
                console.error("Element not found: #level-9-message or #level-9-next");
            }
        } else {
            option.style.backgroundColor = '#FF5252';
        }
    });
});

// Level 9 Next Button
const nextButton = document.getElementById('level-9-next');
if (nextButton) {
    nextButton.addEventListener('click', () => {
        showLevel(10);
    });
} else {
    console.error("Element not found: #level-9-next");
}

        // Level 10: Fireworks Finale
        const letterButtons = document.querySelectorAll('.letter-button');
        letterButtons.forEach(button => {
            button.addEventListener('click', () => {
                const letter = button.getAttribute('data-letter');
                gameState.spellProgress += letter;
                document.getElementById('spelled-name').textContent = gameState.spellProgress;
                
                // Create firework effect
                createFirework(letter);
                
                // Check if name is complete
                if (gameState.spellProgress === 'SUFIYAN') {
                    // Show final message with firework display
                    document.getElementById('final-message').style.display = 'block';
                    document.getElementById('level-10-message').style.display = 'block';
                    document.getElementById('play-again').style.display = 'block';
                    
                    // Grand firework display
                    for (let i = 0; i < 20; i++) {
                        setTimeout(() => {
                            createFirework();
                        }, i * 300);
                    }
                }
            });
        });
        
        function createFirework(letter) {
            const container = document.getElementById('firework-container');
            const colors = ['#ff4081', '#7c4dff', '#00bcd4', '#ffeb3b', '#76ff03'];
            
            // Create the firework center
            const firework = document.createElement('div');
            firework.classList.add('firework');
            firework.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // Random position in container
            const left = Math.random() * 80 + 10;
            const top = Math.random() * 80 + 10;
            firework.style.left = `${left}%`;
            firework.style.top = `${top}%`;
            
            container.appendChild(firework);
            
            // Create particles
            const particleCount = 30;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('firework');
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.left = `${left}%`;
                particle.style.top = `${top}%`;
                
                // Calculate particle trajectory
                const angle = (i / particleCount) * Math.PI * 2;
                const distance = Math.random() * 100 + 50;
                const dx = Math.cos(angle) * distance;
                const dy = Math.sin(angle) * distance;
                
                particle.style.setProperty('--dx', `${dx}px`);
                particle.style.setProperty('--dy', `${dy}px`);
                
                container.appendChild(particle);
                
                // Remove particle after animation
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 1000);
            }
            
            // Add letter if provided
            if (letter) {
                const letterElem = document.createElement('div');
                letterElem.textContent = letter;
                letterElem.style.position = 'absolute';
                letterElem.style.color = 'white';
                letterElem.style.fontSize = '24px';
                letterElem.style.fontWeight = 'bold';
                letterElem.style.left = `${left}%`;
                letterElem.style.top = `${top}%`;
                letterElem.style.zIndex = '10';
                
                container.appendChild(letterElem);
                
                // Animate and remove
                gsap.to(letterElem, {
                    y: -50,
                    opacity: 0,
                    duration: 1.5,
                    onComplete: () => {
                        if (letterElem.parentNode) {
                            letterElem.parentNode.removeChild(letterElem);
                        }
                    }
                });
            }
            
            // Remove firework after animation
            setTimeout(() => {
                if (firework.parentNode) {
                    firework.parentNode.removeChild(firework);
                }
            }, 1000);
        }
        
        document.getElementById('play-again').addEventListener('click', () => {
            // Reset all levels and start again
            gameState.lockAttempt = [];
            gameState.heartsCaught = 0;
            gameState.differencesFound = 0;
            gameState.currentShayariWords = Array(4).fill(null);
            gameState.spellProgress = '';
            
            // Reset visible elements
            document.querySelectorAll('.message').forEach(msg => {
                msg.style.display = 'none';
            });
            
            document.querySelectorAll('button[id$="-next"]').forEach(btn => {
                btn.style.display = 'none';
            });
            
            document.getElementById('play-again').style.display = 'none';
            document.getElementById('final-message').style.display = 'none';
            
            // Show start screen again
            showLevel(0);
        });
    </script>
</body>
</html>